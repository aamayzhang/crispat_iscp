Downstream Analyses 
--------------------------

To investigate the consequences of the assignment differences for discovery analysis, the assignments from crispat can serve as input to differential expression tests performed by various different R and python packages. In this directory we provide some scripts that show how the assignments obtained by crispat can be used for differential expression analysis with **scanpy** (python) and **Seurat** (R). However, we recommend to use the R package **SCEPTRE** for downstream analyses which is tailored to single-cell CRISPR screen analysis and combines multiple analyses and control checks in a statistical rigorous fashion. First, SCEPTRE calculates the log2 fold changes and p-values for the target genes (power check). Next, it calculates the number of false discoveries which are genes that are significantly differentially expressed comparing the cells of one non-targeting gRNA against all other non-targeting control cells (calibration). And finally, it calculates the differentially expressed genes for each perturbation (discovery analysis). More details on SCEPTRE and an explanation of all options can be found [here](https://timothy-barry.github.io/sceptre-book/sceptre.html). All code used for the analyses shown in our paper such as the comparison of the differential expression analysis output obtained by SCEPTRE across methods can be found in a separate [github repository](https://github.com/velten-group/crispat_analysis). We note here that differential expression analysis with SCEPTRE can be time consuming for large screens such as the screen by Replogle et al. (around 2200 gRNAs and 600k cells) used in our paper. For such screens, we recommend to first do the differential expression analysis on a subset of the data only (e.g. subsetting to 40 random targeting gRNAs and all non-targeting gRNAs as done in our analysis) comparing various assignments and then selecting a suitable crispat assignment based on true and false positive rate. 