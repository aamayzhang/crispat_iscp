Search.setIndex({"docnames": [".ipynb_checkpoints/guide_assignment-checkpoint", "data_preparation", "guide_assignment", "index", "method_comparison"], "filenames": [".ipynb_checkpoints/guide_assignment-checkpoint.rst", "data_preparation.rst", "guide_assignment.rst", "index.rst", "method_comparison.rst"], "titles": ["Guide assignment", "Data preparation", "Guide assignment", "Documentation for crispat", "Method comparison"], "terms": {"index": [0, 2, 4], "modul": [], "search": [], "page": [], "crispr": [3, 4], "guid": [1, 3, 4], "assign": [1, 3], "toolkit": [], "packag": [0, 1, 2, 3, 4], "submodul": [], "gc_2beta": [], "gc_3beta": [], "gc_sceptr": [], "gc_umi_t": [], "gc_binomi": [], "gc_cellrang": [], "gc_maximum": [], "gc_neg_binomi": [], "gc_quantil": [], "gc_ratio": [], "gc_replogl": [], "import_data_to_anndata": [], "util": [], "content": [], "fit_betamm": [], "data": [0, 2, 3, 4], "batch": [0, 1, 2], "output_dir": [0, 2], "seed": [], "n_iter": [0, 2], "fit": [0, 2], "mixtur": [0, 2], "model": [0, 2, 3], "2": [0, 2], "beta": [0, 2], "distribut": [0, 2], "ratio": [0, 2], "most": [0, 2], "abund": [0, 2], "grna": [1, 3, 4], "param": [0, 2], "tensor": [], "contain": [0, 1, 2, 4], "proport": [], "highest": [0, 2], "per": [0, 1, 2, 3, 4], "cell": [1, 3], "str": [0, 1, 2, 4], "number": [0, 1, 2, 3], "directori": [0, 1, 2, 4], "which": [0, 1, 2, 4], "result": [0, 2, 3], "plot": 4, "save": 1, "int": [0, 2], "us": [0, 1, 2, 3, 4], "pyro": 2, "step": [0, 2, 3], "train": [0, 2], "return": [0, 1, 2, 4], "paramet": [0, 1, 2, 4], "threshold": [0, 2, 3], "input_fil": [0, 2], "batch_list": [0, 1, 2], "500": [0, 2], "call": [], "i": [0, 1, 2, 3, 4], "determin": [0, 2], "specif": [0, 2, 3], "path": [0, 1, 2], "store": [0, 2], "anndata": [0, 1, 2], "object": [0, 1, 2], "count": [0, 1, 2, 3], "list": [0, 1, 2, 4], "get_ratio": [], "adata_crispr": [], "calcul": [0, 2, 4], "A": 4, "long": [], "datafram": 4, "get_threshold": [], "weight": [], "alpha": [], "find": [0, 2], "from": [0, 1, 2, 3, 4], "probabl": [0, 2], "2nd": [], "compon": [0, 2], "estim": [], "pd": 4, "init_loc_fn": [], "site": [], "defin": [0, 2, 4], "initi": [], "valu": [0, 1, 2, 4], "optim": [], "elbo": [], "svi": [], "loss": [], "function": [0, 1, 2, 3, 4], "observ": [0, 2], "transform": [0, 2], "plot_fitted_model": [], "histogram": [], "np": [], "arrai": [], "map": [], "normal": [], "name": 1, "titl": [], "output": [0, 1, 2, 4], "none": [0, 1, 2, 4], "3": [0, 2], "third": [0, 2], "fit_sceptr": [], "subsample_s": [0, 2], "sceptr": [0, 2, 4], "umi": [0, 2], "one": [0, 1, 2, 4], "captur": [0, 2], "all": [0, 1, 2, 4], "each": [0, 1, 2, 4], "perturb": [0, 2, 3, 4], "specifi": [0, 2, 4], "well": 4, "infer": 2, "start_grna": [0, 2, 4], "0": [0, 2], "grna_step": [0, 2], "2500": [0, 2], "15000": [0, 2], "poisson": [0, 2], "base": [0, 2], "approach": [0, 2], "start": [0, 2, 4], "when": [0, 2, 3], "parallel": [0, 2], "set": [0, 2], "done": [0, 1, 2], "get_perturbed_cel": [], "get": [], "neg": [0, 2], "binomi": [0, 2], "n_batch": [], "conditioned_model": [], "condit": [], "plot_loss": [], "over": [0, 2], "gc_umi": [], "fix": [0, 2], "integ": [0, 2], "creat": [0, 1, 2, 4], "file": [0, 1, 2, 4], "t": [0, 2], "fit_binomi": [], "sigmoid": [0, 2], "x": [0, 2], "call_presence_with_gmm_ab": [], "umi_count": [], "ndarrai": [], "n_compon": [], "cellrang": 1, "github": 4, "repo": [], "http": [], "com": [], "10xgenom": [], "blob": [], "cfa9ac1a9a0fcfbd123dc574934a6a72889d2f70": [], "lib": [], "python": [], "featur": [], "feature_assign": [], "py": [], "l213c1": [], "l235c1": [], "given": [0, 2], "antibodi": [], "separ": [0, 2], "signal": [], "background": [0, 2, 3], "gaussian": [0, 2], "log": [0, 2], "gc_max": [], "fit_negbinomi": [], "gc_negative_binomi": [], "instead": [0, 2], "non": [0, 2, 4], "zero": [0, 2], "ar": [0, 2, 3, 4], "quantil": [0, 2], "compris": [0, 2], "more": [0, 1, 2], "than": [0, 2], "total": [0, 2, 4], "gener": [0, 2], "class": [], "cont_poisson": [], "rate": [], "validate_arg": [], "torchdistribut": [], "arg_constraint": [], "greaterthaneq": [], "lower_bound": [], "expand": [], "batch_shap": [], "_instanc": [], "new": 3, "expandeddistribut": [], "instanc": [], "dimens": [], "tupl": [], "shape": [], "unus": [], "argument": [0, 2], "compat": [], "torch": [], "an": [0, 1, 2, 4], "type": [0, 2], "log_prob": [], "densiti": [], "mass": [], "evalu": [], "sampl": [], "sample_shap": [], "fit_pgmm": [], "log2": [0, 2, 4], "mu": [], "scale": [], "lam": [], "float": [], "mean": [0, 2], "lambda": [0, 2], "poisson_prob": [], "k": [], "p": 4, "prob_normal_compon": [], "belong": [], "create_anndata_from_cellrang": 1, "input_dir": 1, "save_dir": 1, "folder": 1, "batch1": 1, "batch2": 1, "input": [1, 4], "create_anndata_from_csv": 1, "csv_file": 1, "csv": [1, 4], "row": [1, 4], "column": [1, 4], "first": [1, 3, 4], "combine_assign": 4, "data_dir": 4, "end_grna": 4, "combin": 4, "method": [0, 2, 3], "have": [0, 1, 2, 4], "been": 4, "perform": 4, "subset": 4, "indic": 4, "end": 4, "get_intersect": [], "pert_dict": [], "pairwis": 4, "intersect": [0, 2, 3], "dictionari": 4, "cell_grna": [], "similar": [2, 4], "score": [], "load_assign": 4, "gc_dict": 4, "load": 3, "plot_intersection_heatmap": 4, "color": 4, "heatmap": 4, "barplot": 4, "df": 4, "need": [3, 4], "matplotlib": 4, "consist": [], "two": [0, 1, 2], "subfigur": [], "umi_t": [0, 2], "beta2": [], "beta3": [], "maximum": [0, 2], "neg_binomi": [], "replogl": [], "option": [0, 2, 4], "default": [0, 2, 4], "ga_2beta": [0, 2], "ga_3beta": [0, 2], "ga_sceptr": [], "ga_umi": [0, 2], "ga_binomi": [0, 2], "ga_cellrang": [], "ga_max": [0, 2], "ga_negative_binomi": [0, 2], "ga_quantil": [0, 2], "ga_ratio": [0, 2], "ga_replogl": [], "pool": 3, "singl": [3, 4], "screen": [3, 4], "power": [3, 4], "tool": [3, 4], "systemat": 3, "gain": 3, "insight": 3, "consequ": [3, 4], "genet": 3, "high": [0, 2, 3], "throughput": 3, "analys": [3, 4], "To": [0, 1, 2, 3, 4], "allow": 3, "meaning": 3, "downstream": 3, "biolog": 3, "about": 3, "gene": [3, 4], "regulatori": 3, "mechan": 3, "experi": 3, "crucial": 3, "dure": [], "In": [0, 1, 2, 4], "measur": 3, "distinguish": [0, 2, 3], "between": [0, 2, 3], "nois": [], "actual": 3, "state": [0, 2], "howev": [3, 4], "lot": 3, "differ": [0, 2, 3, 4], "strategi": 3, "lab": 3, "without": [0, 2, 3], "ani": [0, 2, 3], "guidanc": 3, "what": 3, "choos": [0, 2, 3], "focus": [], "low": 3, "moi": 3, "crispri": 3, "we": [0, 1, 2, 4], "compar": 4, "variou": 4, "term": [], "effect": 3, "target": [3, 4], "downregul": [], "fals": [0, 2, 4], "discoveri": 4, "The": [0, 2], "thi": [0, 1, 2, 3], "benchmark": [], "includ": 4, "simpl": [], "advanc": [], "take": [], "account": [], "variabl": [0, 2], "both": [0, 2], "even": 1, "though": [], "overlap": [], "across": 3, "vari": [], "strongli": 3, "furthermor": [], "reason": [], "dataset": [], "depend": 1, "sinc": [0, 2], "trade": [], "off": [], "statist": 4, "less": [], "averag": [], "therefor": 4, "provid": [1, 2, 4], "our": [0, 1, 2, 3, 4], "easi": [], "comparison": 3, "suitabl": [0, 2, 3], "If": [0, 1, 2], "avail": [0, 2], "true": [0, 2], "n_process": [0, 2], "bool": [0, 2], "whether": [0, 2], "comput": [0, 2], "process": [0, 2], "cpu": [0, 2], "higher": [0, 2], "200": [], "nonzero": 2, "fite": 2, "onli": [1, 2], "otherwis": 2, "opiton": [], "where": [0, 2, 3], "correspond": 3, "For": [0, 2, 3, 4], "contamin": 3, "presenc": 3, "As": 3, "demonstr": 3, "preprint": [0, 2, 3], "braunger": [], "et": [], "al": [], "2024": [], "link": [], "ad": [0, 2], "soon": [], "choic": [2, 3], "influenc": 3, "highlight": 3, "hand": 3, "reliabl": 3, "analysi": 3, "help": 3, "implement": [0, 2, 3], "11": [0, 1, 2, 3], "facilit": 3, "ga_poisson": [0, 2], "ga_poisson_gauss": [0, 2], "appli": 1, "crispat": [0, 1, 2, 4], "format": 1, "your": 1, "can": [0, 1, 2, 4], "either": [1, 2], "import": 1, "customiz": 1, "directli": 1, "read": 1, "matrix": [0, 1, 2], "h5ad": 1, "yourself": 1, "make": 1, "sure": 1, "add": 1, "adata": 1, "ob": 1, "you": [0, 1, 2], "same": [0, 1, 2], "case": [1, 4], "prepar": 3, "group": [0, 2], "four": [0, 2], "main": [0, 2], "categori": [0, 2], "inform": [0, 2], "share": [0, 2], "detail": [0, 2], "found": [0, 2], "manuscript": [], "veri": [], "simplest": [0, 2], "check": [0, 2, 4], "least": [0, 2], "pass": [0, 2], "autofunct": [], "rel": [0, 2], "frequenc": [0, 2], "ratio_x": [0, 2], "its": [0, 2], "gauss": [0, 2], "everi": [0, 2], "next": [0, 2, 4], "ranger": [0, 2], "log10": [0, 2], "pseudocount": [0, 2], "1": [0, 2], "last": [0, 2], "longest": [0, 2], "run": [0, 2, 4], "time": [0, 2], "automat": [0, 2], "want": [0, 2], "chang": [0, 2, 4], "behaviour": [0, 2], "should": [0, 2], "like": [0, 2], "might": [0, 2], "thu": [0, 2], "infect": [0, 2], "latent": [0, 2], "linear": [0, 2], "exp": [], "beta_0": [0, 2], "beta_1p_c": [0, 2], "beta_2b_c": [0, 2], "s_c": [0, 2], "0r": [], "1r": [], "2rn": [], "pc": [], "covari": [0, 2], "sequenc": [0, 2], "depth": [0, 2], "sc": [], "hot": [0, 2], "encod": [0, 2], "bc": [], "n": [0, 2], "r": [0, 2, 4], "independ": 3, "some": 4, "were": 4, "manual": 4, "distinct": 4, "after": 4, "interest": 4, "frame": 4, "filter": 4, "got": 4, "exactli": 4, "other": 4, "figur": [], "On": [], "left": [], "divid": [], "shown": 4, "right": [], "y": [], "axi": [], "sort": [], "accord": [], "increas": [], "investig": 4, "serv": 4, "differenti": 4, "express": 4, "test": 4, "paper": 4, "timothi": [], "barri": [], "io": [], "book": [], "html": [], "tailor": 4, "multipl": 4, "control": 4, "rigor": 4, "fashion": 4, "fold": 4, "significantli": 4, "against": 4, "calibr": 4, "And": 4, "final": 4, "repositori": 4, "velten": [], "tutori": 4, "downstream_analys": [], "sceptre_discoveri": [], "how": 4, "inut": [], "e": [0, 2], "beta_1": [0, 2], "beta_2": [0, 2], "p_c": [0, 2], "b_c": [0, 2], "modifi": [0, 2], "version": [0, 2], "overdispers": [0, 2], "learnt": [0, 2], "addit": [0, 2], "b": [0, 2], "n_c": [0, 2], "theta_c": [0, 2], "being": [0, 2], "top_x": [0, 2], "top": [0, 2], "exclud": [0, 2], "n_count": [0, 2], "subsampl": [0, 2], "downsampl": [0, 2], "250": 2, "pleas": [], "note": [], "due": [], "variat": 2, "here": [], "v": [], "em": 2, "algorithm": 2, "sklearn": [], "gaussianmixtur": [], "add_umi_count": [0, 2], "improv": [0, 2], "ha": [0, 2], "mani": [0, 2], "user": [0, 2], "mem_limit": [0, 2], "10gb": [0, 2], "memori": [0, 2], "limit": [0, 2], "dask": [0, 2], "cluster": [0, 2], "method_ord": 4, "jaccard": 4, "show": 4, "order": 4, "alphabet": 4, "ga_gauss": 2, "vi": 2, "select": 2, "via": 2, "uniqu": 4, "plot_n_assigned_cel": 4, "also": 4, "possibl": 4, "obtain": 4, "scanpi": 4, "seurat": 4, "do": 4}, "objects": {"crispat": [[2, 0, 1, "", "ga_2beta"], [2, 0, 1, "", "ga_3beta"], [2, 0, 1, "", "ga_binomial"], [2, 0, 1, "", "ga_gauss"], [2, 0, 1, "", "ga_max"], [2, 0, 1, "", "ga_negative_binomial"], [2, 0, 1, "", "ga_poisson"], [2, 0, 1, "", "ga_poisson_gauss"], [2, 0, 1, "", "ga_quantiles"], [2, 0, 1, "", "ga_ratio"], [2, 0, 1, "", "ga_umi"]]}, "objtypes": {"0": "py:function"}, "objnames": {"0": ["py", "function", "Python function"]}, "titleterms": {"welcom": [], "crispat": 3, "": [], "document": 3, "indic": [], "tabl": [], "guide_assign": [], "packag": [], "submodul": [], "gc_2beta": [], "modul": [], "gc_3beta": [], "gc_sceptr": [], "gc_umi_t": [], "gc_binomi": [], "gc_cellrang": [], "gc_maximum": [], "gc_neg_binomi": [], "gc_quantil": [], "gc_ratio": [], "gc_replogl": [], "import_data_to_anndata": [], "util": [], "content": [], "sceptr": [], "umi_t": [], "beta2": [], "beta3": [], "binomi": [], "cellrang": [], "maximum": [], "neg_binomi": [], "quantil": [], "ratio": [], "replogl": [], "list": [], "all": [], "function": [], "data": 1, "prepar": 1, "guid": [0, 2], "assign": [0, 2, 4], "method": 4, "comparison": 4, "chapter": 3, "independ": [0, 2], "across": [0, 2], "grna": [0, 2], "cell": [0, 2, 4], "load": 4, "result": 4, "number": 4, "intersect": 4, "effect": 4, "downstream": 4, "analysi": 4}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 60}, "alltitles": {"Data preparation": [[1, "data-preparation"]], "Documentation for crispat": [[3, "documentation-for-crispat"]], "Chapters:": [[3, null]], "Guide assignment": [[0, "guide-assignment"], [2, "guide-assignment"]], "Independent": [[0, "independent"], [2, "independent"]], "Across gRNAs": [[0, "across-grnas"], [2, "across-grnas"]], "Across cells": [[0, "across-cells"], [2, "across-cells"]], "Across gRNAs and cells": [[0, "across-grnas-and-cells"], [2, "across-grnas-and-cells"]], "Method comparison": [[4, "method-comparison"]], "Load assignment results": [[4, "load-assignment-results"]], "Number of assigned cells and intersection": [[4, "number-of-assigned-cells-and-intersection"]], "Effects on downstream analysis": [[4, "effects-on-downstream-analysis"]]}, "indexentries": {"ga_2beta() (in module crispat)": [[0, "crispat.ga_2beta"], [2, "crispat.ga_2beta"]], "ga_3beta() (in module crispat)": [[0, "crispat.ga_3beta"], [2, "crispat.ga_3beta"]], "ga_binomial() (in module crispat)": [[0, "crispat.ga_binomial"], [2, "crispat.ga_binomial"]], "ga_max() (in module crispat)": [[0, "crispat.ga_max"], [2, "crispat.ga_max"]], "ga_negative_binomial() (in module crispat)": [[0, "crispat.ga_negative_binomial"], [2, "crispat.ga_negative_binomial"]], "ga_poisson() (in module crispat)": [[0, "crispat.ga_poisson"], [2, "crispat.ga_poisson"]], "ga_poisson_gauss() (in module crispat)": [[0, "crispat.ga_poisson_gauss"], [2, "crispat.ga_poisson_gauss"]], "ga_quantiles() (in module crispat)": [[0, "crispat.ga_quantiles"], [2, "crispat.ga_quantiles"]], "ga_ratio() (in module crispat)": [[0, "crispat.ga_ratio"], [2, "crispat.ga_ratio"]], "ga_umi() (in module crispat)": [[0, "crispat.ga_umi"], [2, "crispat.ga_umi"]], "ga_gauss() (in module crispat)": [[2, "crispat.ga_gauss"]]}})