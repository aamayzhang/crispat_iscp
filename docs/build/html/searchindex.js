Search.setIndex({"docnames": ["data_preparation", "guide_assignment", "index", "method_comparison"], "filenames": ["data_preparation.rst", "guide_assignment.rst", "index.rst", "method_comparison.rst"], "titles": ["Data preparation", "Guide assignment", "Documentation for crispat", "Method comparison"], "terms": {"index": 1, "modul": [], "search": [], "page": [], "crispr": [2, 3], "guid": [0, 2, 3], "assign": [0, 2], "toolkit": [], "packag": [0, 1, 2, 3], "submodul": [], "gc_2beta": [], "gc_3beta": [], "gc_sceptr": [], "gc_umi_t": [], "gc_binomi": [], "gc_cellrang": [], "gc_maximum": [], "gc_neg_binomi": [], "gc_quantil": [], "gc_ratio": [], "gc_replogl": [], "import_data_to_anndata": [], "util": [], "content": [], "fit_betamm": [], "data": [1, 2, 3], "batch": [0, 1], "output_dir": 1, "seed": [], "n_iter": 1, "fit": 1, "mixtur": 1, "model": [1, 2], "2": 1, "beta": 1, "distribut": 1, "ratio": 1, "most": 1, "abund": 1, "grna": [0, 2, 3], "param": 1, "tensor": [], "contain": [0, 1, 3], "proport": 3, "highest": 1, "per": [0, 1, 2, 3], "cell": [0, 2], "str": [0, 1, 3], "number": [0, 1, 2], "directori": [0, 1, 3], "which": [0, 1, 3], "result": [1, 2], "plot": 3, "save": 0, "int": 1, "us": [0, 1, 2, 3], "pyro": [], "step": [1, 2], "train": 1, "return": [0, 1, 3], "paramet": [0, 1, 3], "threshold": [1, 2], "input_fil": 1, "batch_list": [0, 1], "500": 1, "call": [], "i": [0, 1, 2, 3], "determin": 1, "specif": [1, 2], "path": [0, 1], "store": 1, "anndata": [0, 1], "object": [0, 1], "count": [0, 1, 2], "list": [0, 1, 3], "get_ratio": [], "adata_crispr": [], "calcul": [1, 3], "A": 3, "long": [], "datafram": 3, "get_threshold": [], "weight": [], "alpha": [], "find": 1, "from": [0, 1, 2, 3], "probabl": 1, "2nd": [], "compon": 1, "estim": [], "pd": 3, "init_loc_fn": [], "site": [], "defin": 1, "initi": [], "valu": [0, 1, 3], "optim": [], "elbo": [], "svi": [], "loss": [], "function": [0, 1, 2, 3], "observ": 1, "transform": 1, "plot_fitted_model": [], "histogram": [], "np": [], "arrai": [], "map": [], "normal": [], "name": 0, "titl": [], "output": [0, 1, 3], "none": [0, 1, 3], "3": 1, "third": 1, "fit_sceptr": [], "subsample_s": 1, "sceptr": [1, 3], "umi": 1, "one": [0, 1, 3], "captur": 1, "all": [0, 1, 3], "each": [0, 1, 3], "perturb": [1, 2, 3], "specifi": [1, 3], "well": [], "infer": [], "start_grna": [1, 3], "0": 1, "grna_step": 1, "2500": 1, "15000": 1, "poisson": 1, "base": 1, "approach": 1, "start": [1, 3], "when": [1, 2], "parallel": 1, "set": 1, "done": [0, 1], "get_perturbed_cel": [], "get": [], "neg": 1, "binomi": 1, "n_batch": [], "conditioned_model": [], "condit": [], "plot_loss": [], "over": 1, "gc_umi": [], "fix": 1, "integ": 1, "creat": [0, 1, 3], "file": [0, 1, 3], "t": 1, "fit_binomi": [], "sigmoid": 1, "x": 1, "call_presence_with_gmm_ab": [], "umi_count": [], "ndarrai": [], "n_compon": [], "cellrang": 0, "github": 3, "repo": [], "http": [], "com": [], "10xgenom": [], "blob": [], "cfa9ac1a9a0fcfbd123dc574934a6a72889d2f70": [], "lib": [], "python": [], "featur": [], "feature_assign": [], "py": [], "l213c1": [], "l235c1": [], "given": 1, "antibodi": [], "separ": 1, "signal": [], "background": [1, 2], "gaussian": 1, "log": 1, "gc_max": [], "fit_negbinomi": [], "gc_negative_binomi": [], "instead": 1, "non": [1, 3], "zero": 1, "ar": [1, 2, 3], "quantil": 1, "compris": 1, "more": [0, 1], "than": 1, "total": 1, "gener": 1, "class": [], "cont_poisson": [], "rate": [], "validate_arg": [], "torchdistribut": [], "arg_constraint": [], "greaterthaneq": [], "lower_bound": [], "expand": [], "batch_shap": [], "_instanc": [], "new": 2, "expandeddistribut": [], "instanc": [], "dimens": [], "tupl": [], "shape": [], "unus": [], "argument": 1, "compat": [], "torch": [], "an": [0, 1, 3], "type": 1, "log_prob": [], "densiti": [], "mass": [], "evalu": [], "sampl": [], "sample_shap": [], "fit_pgmm": [], "log2": [1, 3], "mu": [], "scale": [], "lam": [], "float": [], "mean": 1, "lambda": 1, "poisson_prob": [], "k": [], "p": 3, "prob_normal_compon": [], "belong": [], "create_anndata_from_cellrang": 0, "input_dir": 0, "save_dir": 0, "folder": 0, "batch1": 0, "batch2": 0, "input": [0, 3], "create_anndata_from_csv": 0, "csv_file": 0, "csv": [0, 3], "row": [0, 3], "column": [0, 3], "first": [0, 2, 3], "combine_assign": 3, "data_dir": 3, "end_grna": 3, "combin": 3, "method": [1, 2], "have": [0, 1, 3], "been": 3, "perform": 3, "subset": 3, "indic": 3, "end": 3, "get_intersect": [], "pert_dict": [], "pairwis": 3, "intersect": [1, 2], "dictionari": 3, "cell_grna": [], "similar": [], "score": [], "load_assign": 3, "gc_dict": 3, "load": 2, "plot_intersection_heatmap": 3, "color": 3, "heatmap": 3, "barplot": 3, "df": 3, "need": [2, 3], "matplotlib": 3, "consist": 3, "two": [0, 1, 3], "subfigur": 3, "umi_t": 1, "beta2": [], "beta3": [], "maximum": 1, "neg_binomi": [], "replogl": [], "option": [1, 3], "default": 1, "ga_2beta": 1, "ga_3beta": 1, "ga_sceptr": [], "ga_umi": 1, "ga_binomi": 1, "ga_cellrang": 1, "ga_max": 1, "ga_negative_binomi": 1, "ga_quantil": 1, "ga_ratio": 1, "ga_replogl": [], "pool": 2, "singl": [2, 3], "screen": [2, 3], "power": [2, 3], "tool": 2, "systemat": 2, "gain": 2, "insight": 2, "consequ": [2, 3], "genet": 2, "high": [1, 2], "throughput": 2, "analys": [2, 3], "To": [0, 1, 2, 3], "allow": 2, "meaning": 2, "downstream": 2, "biolog": 2, "about": 2, "gene": [2, 3], "regulatori": 2, "mechan": 2, "experi": 2, "crucial": 2, "dure": [], "In": [0, 1, 3], "measur": 2, "distinguish": [1, 2], "between": [1, 2], "nois": [], "actual": 2, "state": 1, "howev": 2, "lot": 2, "differ": [1, 2, 3], "strategi": 2, "lab": 2, "without": [1, 2], "ani": [1, 2], "guidanc": 2, "what": 2, "choos": [1, 2], "focus": [], "low": 2, "moi": 2, "crispri": 2, "we": [0, 1, 3], "compar": 3, "variou": [], "term": [], "effect": 2, "target": [2, 3], "downregul": [], "fals": [1, 3], "discoveri": 3, "The": 1, "thi": [0, 1, 2], "benchmark": [], "includ": [], "simpl": [], "advanc": [], "take": [], "account": [], "variabl": 1, "both": [1, 3], "even": 0, "though": [], "overlap": 3, "across": 2, "vari": [], "strongli": 2, "furthermor": [], "reason": [], "dataset": [], "depend": 0, "sinc": 1, "trade": [], "off": [], "statist": 3, "less": [], "averag": [], "therefor": [], "provid": [0, 3], "our": [0, 1, 2, 3], "easi": [], "comparison": 2, "suitabl": [1, 2], "If": [0, 1], "avail": 1, "true": 1, "n_process": 1, "bool": 1, "whether": 1, "comput": 1, "process": 1, "cpu": 1, "higher": 1, "200": [], "nonzero": 1, "fite": 1, "onli": [0, 1], "otherwis": 1, "opiton": 1, "where": [1, 2], "correspond": 2, "For": [1, 2, 3], "contamin": 2, "presenc": 2, "As": 2, "demonstr": 2, "preprint": 2, "braunger": 2, "et": 2, "al": 2, "2024": 2, "link": [1, 2], "ad": [1, 2], "soon": [1, 2], "choic": 2, "influenc": 2, "highlight": 2, "hand": 2, "reliabl": 2, "analysi": 2, "help": 2, "implement": [1, 2], "11": [0, 1, 2], "facilit": 2, "ga_poisson": 1, "ga_poisson_gauss": 1, "appli": 0, "crispat": [0, 1, 3], "format": 0, "your": 0, "can": [0, 1, 3], "either": 0, "import": 0, "customiz": 0, "directli": 0, "read": 0, "matrix": [0, 1], "h5ad": 0, "yourself": 0, "make": 0, "sure": 0, "add": 0, "adata": 0, "ob": 0, "you": [0, 1], "same": [0, 1], "case": [0, 3], "prepar": 2, "group": 1, "four": 1, "main": 1, "categori": 1, "inform": 1, "share": 1, "detail": 1, "found": 1, "manuscript": 1, "veri": 1, "simplest": 1, "check": [1, 3], "least": 1, "pass": 1, "autofunct": [], "rel": 1, "frequenc": 1, "ratio_x": 1, "its": 1, "gauss": 1, "everi": 1, "next": [1, 3], "ranger": 1, "log10": 1, "pseudocount": 1, "1": 1, "last": 1, "longest": 1, "run": [1, 3], "time": 1, "automat": 1, "want": 1, "chang": [1, 3], "behaviour": 1, "should": 1, "like": 1, "might": 1, "thu": 1, "infect": 1, "latent": 1, "linear": 1, "exp": [], "beta_0": 1, "beta_1p_c": 1, "beta_2b_c": 1, "s_c": 1, "0r": [], "1r": [], "2rn": [], "pc": [], "covari": 1, "sequenc": 1, "depth": 1, "sc": [], "hot": 1, "encod": 1, "bc": [], "n": 1, "r": [1, 3], "independ": 2, "some": 3, "were": 3, "manual": 3, "distinct": 3, "after": 3, "interest": 3, "frame": 3, "filter": 3, "got": 3, "exactli": 3, "other": 3, "figur": 3, "On": 3, "left": 3, "divid": 3, "shown": 3, "right": 3, "y": 3, "axi": 3, "sort": 3, "accord": 3, "increas": 3, "investig": 3, "serv": 3, "differenti": 3, "express": 3, "test": 3, "paper": 3, "timothi": [], "barri": [], "io": [], "book": [], "html": [], "tailor": 3, "multipl": 3, "control": 3, "rigor": 3, "fashion": 3, "fold": 3, "significantli": 3, "against": 3, "calibr": 3, "And": 3, "final": 3, "repositori": 3, "velten": [], "tutori": 3, "downstream_analys": [], "sceptre_discoveri": [], "how": 3, "inut": 3, "e": 1, "beta_1": 1, "beta_2": 1, "p_c": 1, "b_c": 1, "modifi": 1, "version": 1, "overdispers": 1, "learnt": 1, "addit": 1, "b": 1, "n_c": 1, "theta_c": 1, "being": 1, "top_x": 1, "top": 1, "exclud": 1}, "objects": {"crispat": [[1, 0, 1, "", "ga_2beta"], [1, 0, 1, "", "ga_3beta"], [1, 0, 1, "", "ga_binomial"], [1, 0, 1, "", "ga_cellranger"], [1, 0, 1, "", "ga_max"], [1, 0, 1, "", "ga_negative_binomial"], [1, 0, 1, "", "ga_poisson"], [1, 0, 1, "", "ga_poisson_gauss"], [1, 0, 1, "", "ga_quantiles"], [1, 0, 1, "", "ga_ratio"], [1, 0, 1, "", "ga_umi"]]}, "objtypes": {"0": "py:function"}, "objnames": {"0": ["py", "function", "Python function"]}, "titleterms": {"welcom": [], "crispat": 2, "": [], "document": 2, "indic": [], "tabl": [], "guide_assign": [], "packag": [], "submodul": [], "gc_2beta": [], "modul": [], "gc_3beta": [], "gc_sceptr": [], "gc_umi_t": [], "gc_binomi": [], "gc_cellrang": [], "gc_maximum": [], "gc_neg_binomi": [], "gc_quantil": [], "gc_ratio": [], "gc_replogl": [], "import_data_to_anndata": [], "util": [], "content": [], "sceptr": [], "umi_t": [], "beta2": [], "beta3": [], "binomi": [], "cellrang": [], "maximum": [], "neg_binomi": [], "quantil": [], "ratio": [], "replogl": [], "list": [], "all": [], "function": [], "data": 0, "prepar": 0, "guid": 1, "assign": [1, 3], "method": 3, "comparison": 3, "chapter": 2, "independ": 1, "across": 1, "grna": 1, "cell": [1, 3], "load": 3, "result": 3, "number": 3, "intersect": 3, "effect": 3, "downstream": 3, "analysi": 3}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 60}, "alltitles": {"Data preparation": [[0, "data-preparation"]], "Documentation for crispat": [[2, "documentation-for-crispat"]], "Chapters:": [[2, null]], "Guide assignment": [[1, "guide-assignment"]], "Independent": [[1, "independent"]], "Across gRNAs": [[1, "across-grnas"]], "Across cells": [[1, "across-cells"]], "Across gRNAs and cells": [[1, "across-grnas-and-cells"]], "Method comparison": [[3, "method-comparison"]], "Load assignment results": [[3, "load-assignment-results"]], "Number of assigned cells and intersection": [[3, "number-of-assigned-cells-and-intersection"]], "Effects on downstream analysis": [[3, "effects-on-downstream-analysis"]]}, "indexentries": {}})